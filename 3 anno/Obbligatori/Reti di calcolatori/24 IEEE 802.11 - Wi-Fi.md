---
publish: true
creation: 2024-12-31T11:51:00
---
# Physical Layer

La versione più comune di *Wi-Fi* ustilizza :
+ Bande di frequenza tra $2.4$ o $5Ghz$
+ *Bitrate* : $11-6700 Mbps$
+ *Range* : $50m$ indoor , $300m$ outdoor , anche kilometri per apparecchi professionali
+ Supporta la mobilità 
## Frequenze

Generalmente **Wi-Fi** opera su frequenze *unlicensed* , ossia frequenze che non necessitano una licenza per emettere segnali , queste sono dette **ISM** ( *Industrial, Scientific and Medical* )  :
+ $2.4$ - $2.4835 GHz$ ( $835 MHz$  di banda ) 
+ $5.17 - 5.33$ e $5.49 - 5.710$ ( $160$ e $220 MHz$ di banda )
>[!warning] 
>Queste bande non vengono solo utilizzate da **Wi-Fi** possono quindi causare interferenze

## Canali 

Per $2.4 GHz$ ci sono $11$ canali mentre per $5GHz$ ce ne sono $19$

>[!note] 
>I canali possono essere più o meno usati uno indipendente dall'altro

>[!example] 
>Canali per $802.11b/g$
>![[Pasted image 20241231153432.png]]

Come si può notare ogni canale è grande $22MHz$ e solo $3$ di questi ( $1,6,11$ ) sono completamete separati tra loro , questo permette di avere $3$ *network* separati che non causano interferenza l'uno con l'altro

>[!warning] 
Quando due canali non sono completamente separati allora il segnale dal primo diventa *rumore* per il secondo

Per $5GHz$ **802.11ac** usa canali grandi $20MHz$ e ne definice $30$ ma in europa se ne possono usare solo $19$ 

>[!note] 
>Questo fa in modo che sia meno probabile che vi sia interferenza tra **Access Points** vicini 
### Channel Aggregation

In **802.11n/ac** i canali possono essere aggregati : 
+ **802.11n** permette di aggregare solo due canali
+ **802.11ac** permette invece di aggregare fino a $160MHz$ ( $4$ canali ) in un singolo canale

>[!example] 802.11ac
>![[Pasted image 20241231154458.png]]

Se un *network* non ha alcun altro *network* vicino , ha quindi l'intero spettro per se può usare una canale da $160MHz$ 

Se invece c'è un altro network ognuno può usare $80MHz$ o in alcuni casi entrambi possono usare $160MHz$ ma si decono coordinare in modo da non trasmettere nello stesso momento

# MAC Layer 

## Tipo di Traffico 

Ci sono tre tipi di *Frame* nello standard **802.11** : 
+ *Managment frame* : tutto ciò che non trasporta traffico ma è necessario per gestire la comunicazione ( fino a poco tempo fa non erano cifrati o autenticati )
>[!example] 
>+ *authentication frame*
>+ *association frame*
>+ *beacon frame*
+ *Control frame* : Usati per controllare l'accesso ad un certo canale ( non sono cifrati nè autenticati )
>[!example] 
>+ **RTS/CTS** frame
>+ **ACK** frame
+ *Data frame* : Portano traffico ( possono essere autenticati e cifrati ) 

## Definizioni 

+ Un **Besic Service Set** ( **BSS** ) è l'unità più piccola che fa parte di un network **802.11** 

Un **BSS** può essere di due tipi : 
+ **Infrastructured** :
	+ In questo modello c'è un **Access Point** e alcune *stazioni* connesse , queste scambiano traffico solamente tra loro e gli **Access Point** 
	+ Le *stazioni* non comunicano mai tra di loro direttamente , l'**AP** diventa quindi centrale 
+ **Independent**

Ogni **BSS** è identificato da un **BSSID** , questo è un numero di $48$bit costuito usando l'indirizzo **MAC** dell'**AP**

Ogni **AP** può scegliere un **SSID** ( **Service Set ID** ) ossia un nome leggibile per il **BSS** 
>[!note] 
>Configurabile dall'amministratore

Più **BSS** possono essere *linkati* tra di loro usando un **DS** ( **Distribution Service** ) , questo è un link tra i vari **AP** per creare un unico **BSS** 

>[!note] 
>Questo *link* è generalmente un link fisico 

Questo viene chiamato **Extended Service Set** ( **ESS** ) 

>[!note] 
>Normalmente le stazioni connesse ad un **ESS** sono nello stesso segmento del *network* **IP** , in questo modo possono comunicare tra di loro 
>
>Gli **AP** condividono generalmente lo stesso **SSID**

## Beacon Frames

Ogni **AP** emette *beacon* frame periodicamente ( 10 volte al secondo ) , questi contengon le informazioni del **BSS** ( **BSSID** , **SSID** $\dots$ ) 

Una *stazione* che vuole entrare nel *network* deve fare i seguenti tre passi : 
+ *Scanning*
+ *Authentication*
+ *Association* 
### Scanning 

Una *stazione* che vuole entrare a far parte di un **BSS** deve contattare l'**AP** , questo può essere fatto in due modi : 
+ *Passive scan* : La *stazione* ascolta per poco tempo su ogni canale , aspettando per un frame *beacon*
+ *Active scan* : La stazione invia una *Probe-Request* frame su tutti i canali , tutti gli **AP** che lo ricevono rispondono con un *Probe-Response*

### Authentication and Association 

Queste due fasi vengono fatte dal *client* solo una volta , queste vengono usate per creare un canale sicuro tra ogni *client* e un *singolo* **AP** tra quelli che sono nell'**ESS** 

### State Machine

![[Pasted image 20241231164207.png]]

## Data Frames

![[Pasted image 20241231164540.png]]

+ `Frame Control` : Tipo / Sottotipo , Retry , From / To-**DS**
+ `Duration`
+ `Addresses` : 
	1. Indirizzo dell'**AP**
	2. Indirizzo della *fonte* del frame
	3. Indirizzo di *destinazione* del frame  
>[!note] 
>La loro interpretazione dipende dai bit settati in `Frame Control` 
+ `Sequence Control` : numero unico per identificare *ritrasmissione* 
+ `CRC` : [[CRC]] 

I pacchetti **IP** sono incapsulati in un frame **802.11** usando un header **LLC** ( per definire il tipo del pacchetto )
## Access Control

Le varie *stazioni* non possono comunicare allo stesso tempo altrimenti potrebbero avvenire *collisioni* 
### Collision Detection

Visto che le collisioni avvengono al *receiver* il *sender* non saprà se il frame era stato ricevuto correttamente , per confermare che un frame è arrivato correttamente il *reciever* invia una [[Acknowledgment|ack]] 

>[!summary] Failed Transmission
>Una trasmissione si dice fallita se dopo un certo tempo il *sender* non riceve un [[Acknowledgment|ack]] 
### Carrier Sensing

Un modo semplice per evitare le *collisioni* è controllare prima di trasmettere se qualcun'altro sta trasmettendo 

Questo è definito come un tipo di *layer* **MAC** : **CSMA/CA** ( **Carrier Sensing Multiple Access / Collision Avoidance** )
### MAC Efficency

>[!note] Channel State 
>
>Un canale **Wi-Fi** può essere *idle* ( nessuno sta trasmettendo ) o *occupied/busy* ( qualcuno sta trasmeettendo )

Il compito del **MAC** è quindi quello di fare in modo di massimizzare il tempo in cui il canale è *busy*

I *terminali* però per coordinarsi necessitano di avere del tempo *idle* , per questo un efficenza del $100\%$ non può essere mai raggiunta

Ci sono due modi in cui il **MAC** può fare coordinazione 

#### PCF ( Point Coordination Function ) 

E' una modalità di coordinazione centralizzata dove l'**AP** invierà ai terminali una *schedule* dove allocca un intervallo di terminale per ogni *terminale* 

Implementa un [[TDMA]] centralizzato 

#### DCF ( Distributed Coordination Function )

Implementa un *random access scheme* , un modello simile ad [[S-ALHOA]] , è basato da una definizione di intervalli , momenti di attesa e *policy* di ritrasmissione 

>[!note] 
>Ci sono due versioni entrambe mandatorie
>
##### Steb by step 

Ogni nodo che vuole trasmettere un *frame* prima deve ascoltare su quel canale , se il canale è *idle* aspetta per un tempo determinato  **DIFS** ( **DCF Interface Space** , questo valore dipende dallo standard , in **802.11n/ac** è $16\mu s$)

Se il canale rimane *idle* per l'intera durata di **DIFS** allora tramette il frame 

Colui che riceve il *frame* calcola la *CRC* e controlla se è corretta , se è corretto allora aspetta un ulteriore tempo detto **SIFS ( short-IFS )** e invia l'[[Acknowledgment|ack]] 

>[!note] SIFS / DIFS timer
>
>Questi timer dipende da varie configurazioni 
>>[!example] 
>>| Standard Version   | DIFS | SIFS |
| ------------------ | :--: | :--: |
| 802.11n/ac 2.4 GHz |  28  |  10  |
| 802.11n/ac 5 GHz   |  34  |  16  |

>[!example] 
>Un solo trasmettitore
>![[Pasted image 20241231180340.png]]

