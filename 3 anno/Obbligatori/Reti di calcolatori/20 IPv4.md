---
publish: true
creation: 2024-12-27T23:20:00
---
# Point-to-Point Datalink Layers ( PPP )

In un link **PPP** ci sono solo due dispositivi che comunicano tra di loro 

Non necessitiamo l'uso di routing visto che la comunicazione avviene solo tra due dispositivi 
## PPPoE / PPPoA

Un esempio è la connesione **DSL** di casa 

Il *router* di casa deve connettersi ad un altro router direttametne attraverso un cavo ( non dobbiamo fare *routing* o *forwarding* )

Un link **PPP** può usare un protocollo come *Ethernet* ( **PPPoE** ) o *ATM* ( **PPPoA** )

### LAN ( Local Area Network ) 

Una *LAN* è un network di dispositivi connessi tra di loro , ognuno ha un indirizzo unico , indirizzo **MAC** 

Visto che possono esserci molti dispositivi collegati tra di loro necessitiamo di avere un **MAC** di *destinazione* e di *fonte* 

>[!note] 
>E' possibile anche inviare dei pacchetti a tutti gli altri host , utilizziamo un indirizzo speciale ( *broadcast* address )
# IPv4

Ogni *host* connesso ad un network possiede un numero di *Network Interface Cards* ( *NIC* ) 

Ad ogni *NIC* può essere asseganto un indirizzo **IP** 

>[!note] 
>Generalmente un computer che non è un router ha un solo *NIC* e quindi un solo **IP**

Un indirizzo **IP** è lungo $32$bit , rappresentato in *dotted decimal notation* ( 4 numeri decimali da 0 a 255 separati da punti ) 
>[!example] 
>`1.2.3.4` = `00000001 00000010 00000011 00000100`
>`127.0.0.1` = `01111111 00000000 00000000 00000001`
>`255.255.255.255` = `11111111 11111111 11111111 11111111`

## Network Organization

Una rete può essere divisa in sottoreti ( *subnet* ) connesse da *router* 

Una sottorete è identificata da un gruppo di indirizzi nella forma `x.y.z.w/N` dove `N` è usato per calcolare il numero totale di indirizzi della sottorete ( $2^{32-N}$ )

Un indirizzo **IP** viene diviso in un *prefisso* che identifica la sottorete ( **netid** ) e un *suffisso* che identifica il singolo *NIC* all'interno della rete ( **hostid** )

>[!note] 
>Tutti i *NIC* all'interno della sottorete hanno lo stesso *prefisso* ( *netid* )

La divisione in *subnet* può essere :
+ *classless* , questo da più flessibilità di scelta degli indirizzi ed è più usato al giorno d'oggi 
>[!example] 
>+ `192.168.0.0/24` : $24$ bit per il network , $8$ bit host , $2^8$ indirizzi nella *subnet*
>+ `192.168.0.0/30` : $30$ bit per il network , $2$ bit host , $2^2$ indirizzi nella *subnet*
>+ `157.138.0.0/16` : $16$ bit per il network , $16$ bit host , $2^16$ indirizzi nella *subnet*
>+ `10.0.0.0/8` : $8$ bit per il network , $24$ bit host , $2^24$ indirizzi nella *subnet*
+ Divisa in *classi* predefinite : esistono $3$ classi in cui possiamo dividere un indirizzo ip : **A** ( `/8` ) , **B** ( `/16` ) , **C** ( `/24` )
### IP Address Allocation

>[!note] 
Idealmente ogni *NIC* deve avere un indirizzo **IP** unico 

Il *netid* viene assegnato dalla **IANA** ( *Internet Assigned Number Authority* ) 
L'*hostid* viene invece assegnato dall'amministratore della rete locale 

Ogni *subnet* ha due indirizzi speciali che *non* possono essere assegnati ad alcun *NIC* :
+ *hostid = 0* : questo identifica il *network* e non può essere usato
+ *hostid = tutti 1* : questo rappresenta l'indirizzo di *broadcast*

>[!example] 
>`192.168.0.0/24` :
>+ `192.168.0` : *netid*
>+ `192.168.0.0` : *network address*
>+ `192.168.0.255` : *broadcast address*
#### Broadcast Address

L'indirizzo di *broadcast* viene usato per inviare un pacchetto a tutti gli **IP** della sottorete 

>[!example] 
>Se un *NIC* ha come indirizzo `1.2.3.4` ed è in una *subnet* `/24` e vuole inviare un pacchetto a tutti gli altri host lo invierà a `1.2.3.255`  

>[!note] 
>Se un *NIC* non ha ancora assegnato un indirizzo **IP** ma vuole inviare un pacchetto in broadcast può farlo mandandolo a `255.255.255.255` ( *Limited Broadcast Address* ) , Infatti non sapendo il *netid* non può fare altrimenti
#### Multicast Addresses

Indirizzi che iniziano con `1110` , o `224.0.0.0/4` sono indirizzi *multicast* , questi sono usati da gruppi di *host* che volgiono comunicare tra loro 

>[!example] 
>+ `224.0.0.1` : tutti gli *host* nella sottorete tranne i *router*
>+ `224.0.0.2` : tutti i *router*

#### Special Addresses

+ `0.0.0.0/8` : Rappresenta questa macchina in questo network , può essere solo usato come indirizzo *sorgente* ( ex per **DHCP** )
+ `127.0.0.0/8` : Interfaccia di *loopback* , questa non è connessa ad alcuna interfaccia fisica e ha indirizzo `127.0.0.1` , viene usata per gestire connessioni [[18 TCP - UDP#Transmission Control Protocol (TCP)|TCP]] all'interno della stessa macchina
+ `10.0.0.0/8` , `172.16.0.0/12` , `192.168.0.0/16` : classi di indirizzi *private* , questi non vengono instradati dai router ( nè in entrata nè in uscita )
+ `169.254.0.0/16` : indirizzo *link-local* , è usato per *NIC* a cui non è ancora stato assegnato un indirizzo **IP** per comunicare ( non è instradabile ) 

### Intra-Net communication

>[!note] 
>Assumiamo che tutti gli *host* all'interno di una stessa *sottorete* possano comunicare tra di loro 

*Host* all'interno di una certa *subnet* non possono comunicare direttamente con un *host* all'interno di un'altra sottorete 
#### Routers

**Router** sono dispositivi che appartengono a più di una sottorete 

Ciò significa che posseggono più id un *NIC* , e ognuno ha un *indirizzo* diverso in ogni *sottorete* di cui il *router* fa parte

In questo modo possono ricevere paccheta da una sottorete e passarli ad un altra per cui hanno un *NIC*

>[!example] 
>![[Pasted image 20241228121433.png]]

>[!note] 
>Ogni *subnet* ha almeno un *router* ( a meno che essa sia isolata )
>
>Ogni *host* ha un *router di defualt* che usa per inviare pacchetti quando non sono indirizzati verso un indirizzo **IP** all'interno della *subnet*
##### Local Routers Vs Gateway

Pacchetti inviati a qualche **IP** locale verranno inviati al router locale che assumerà che la destinazione sia raggiungibile direttamente 

Un pacchetto che invece vuole andare al di fuori della rete locale dovrà specificare l'indirizzo del **gateway** che vuole usare per raggiungere la sua destinazione 

Nella routing table deve essere specificato l'indirizzo del *getaway* di default quando inviamo paccheti con indirizzi non appartenenti alla *local network* 

>[!example] 
>`default via 192.168.26.174 dev wlp0s20f3 proto dhcp metric 600`
>
>>[!warning] 
>>L'**IP** destinazione deve essere una destinazione reale , non può essere cambiata 

##### Multi-Home hosts

Un *NIC* può avere assegnato più di un indirizzo **IP** 

>[!note] 
>Questo non rende il *NIC* un *router* 
>
>Inoltre questo non fa in modo che pacchetti vengano intradati tra gli **IP**
## IPv4 Header

![[Pasted image 20241228160935.png]]

Dove :
+ `version` : può essere 4 o 6 principalmente
+ `IHL` ( *IP Header Lenght* ) : 
	La lunghezza dell'header in numero di *words* di `32`bit ( min `5` max `15` )
+ `DS` o `Type of Service`: 
	Questo campo viene usato per `Quality of Service` options ( ex [[18 TCP - UDP#Explicit Congestion Control ( ECN )|Explicit Congestion Control ( ECN )]] )
+ `Total Lenght` : Lunghezza in byte dei pacchetti ( max $65535B$ )
+ `Identification` : usato per linkare segmenti assieme
+ `Flags` : 
	Possono essere *flag* per ex *Evil Bit* , *Don't Fragment* ( Non accetta frammentazione dei pacchetti , usato per scoprire il massimo **MTU** del cammino ) , *More Fragments*
+ `Fragment Offset` : 
	L'offset di un *fragment* rispetto al pacchetto originale ( multiplo di $8$ byte escludento l'*header* )
+ `TTL` : *time to leave* , diminuito per ogni loop 
+ `Protocol` : **ICMP** , **TCP** , **UDP**
+ `Header Checksum` : Una *checksum* per l'*header*
+ `Source and Destination Address` 

`Options` sono normalmente non utilizzate 
## Fragmentation

Visto che diversi *datalink* possono supportare diversi **MTU** ( ex Ethernet : $1500$ , 802.11 ( Wi-Fi ) : $2272$ )

Se abbiamo un pacchetto più grande dell'**MTU** dobbiamo frammentarlo 

>[!note] 
>**IP** *Fragmentation* è fatto ad ogni router e riassemblato a destinazione 

I frammenti creati hanno : 
+ lo stesso campo `Identification`
+ campo `Lenght` relativo al frammento
+ campo `Offset` che dipende dalla posizione del fragment nel pacchetto originale 
+ `More Fragment` flag settato a `1` tranne l'ultimo 

>[!example] 
>![[Pasted image 20241228165031.png]]
>Ogni fragment dovrà aggiungere un *header* **IP** ( la dimensione è $3500$ )
>
>+ *Fragmet 1* : 
>	+ Avrà come dimensione : 20 byte di *header* **IP** e 1480 di *payload*
>	+ *more fragment* viene settato a `True` 
>	+ `Fragment Offset` settato a $0$ 
>	+ `Lenght` è settato a $1480 + 20$
>+ *Fragmet 2* : 
>	+ Avrà come dimensione : 20 byte di *header* **IP** e 1480 di *payload*
>	+ *more fragment* viene settato a `True` 
>	+ `Fragment Offset` settato a $1480/8 = 185$ 
>	+ `Lenght` è settato a $1480 + 20$
>+ *Fragmet 3* : 
>	+ Avrà come dimensione : 20 byte di *header* **IP** e 540 di *payload*
>	+ *more fragment* viene settato a `False`
>	+ `Fragment Offset` settato a $370$
>	+ `Lenght` è settato a $540 + 20$

Ogni *Fragment* raggiunge la destinazione come un *pacchetto* indipendente

Solo alla destinazione sono 